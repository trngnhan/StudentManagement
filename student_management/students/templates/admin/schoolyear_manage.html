{% extends "base.html" %}
{% load static %}

{% block title %}Quáº£n lÃ½ NÄƒm há»c{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2 class="text-center text-primary fw-bold">ğŸ“† Quáº£n lÃ½ NÄƒm há»c</h2>

  <!-- Form táº¡o nÄƒm há»c -->
  <div class="card mt-4">
    <div class="card-header bg-primary text-white">â• Táº¡o NÄƒm há»c</div>
    <div class="card-body">
      <form method="post" action="{% url 'schoolyear_manage_view' %}" class="row g-2">
        {% csrf_token %}
        <div class="col-md-10">
          <input type="text" class="form-control" name="school_year_name" placeholder="VD: NÄƒm há»c 2025 - 2026" required>
        </div>
        <div class="col-md-2">
          <button type="submit" class="btn btn-success w-100">LÆ°u</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Danh sÃ¡ch nÄƒm há»c -->
  <div class="mt-5">
    <h4 class="mb-3 text-primary fw-bold">ğŸ“‹ Danh sÃ¡ch NÄƒm há»c</h4>
    <div id="schoolYearList" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
      {% for sy in schoolyears %}
        <div class="col">
          <div class="card shadow-sm border-primary">
            <div class="card-body text-center">
              <h5 class="card-title text-primary fw-bold">{{ sy.school_year_name }}</h5>
              <a href="{% url 'semesters_of_schoolyear_view' sy.id %}" class="btn btn-info btn-sm mt-2">Xem há»c ká»³</a>
              <form method="post" action="{% url 'schoolyear_delete_view' sy.id %}" style="display:inline;" onsubmit="setTimeout(function(){location.reload()}, 500);">
                {% csrf_token %}
                <button type="submit" class="btn btn-danger btn-sm mt-2" onclick="return confirm('XÃ¡c nháº­n xoÃ¡ nÄƒm há»c nÃ y?')">ğŸ—‘ï¸ XoÃ¡</button>
              </form>
            </div>
          </div>
        </div>
      {% empty %}
        <div class="col text-center text-muted">KhÃ´ng cÃ³ nÄƒm há»c nÃ o.</div>
      {% endfor %}
    </div>
  </div>
</div>

<script>
  document.querySelectorAll('form[action*="schoolyear/delete"]').forEach(function(form) {
    form.addEventListener('submit', function() {
      setTimeout(function(){ location.reload(); }, 500);
    });
  });
</script>

{% endblock %}